:root {
    --bg-light: #f4f7f9; --card-bg-light: #ffffff; --text-primary-light: #1a202c; --text-secondary-light: #5f6b7c;
    --border-light: #e2e8f0; --accent-color: #4a69ff; --accent-hover: #3c54d1;
    --success-color: #34d399; --error-color: #ef4444; --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --border-radius: 12px;
    
    --bg-dark: #121212; --card-bg-dark: #1e1e1e; --text-primary-dark: #e5e7eb; --text-secondary-dark: #9ca3af;
    --border-dark: #374151;
}

[data-theme="light"] {
    --bg-color: var(--bg-light); --card-bg: var(--card-bg-light); --text-primary: var(--text-primary-light);
    --text-secondary: var(--text-secondary-light); --border-color: var(--border-light);
}

[data-theme="dark"] {
    --bg-color: var(--bg-dark); --card-bg: var(--card-bg-dark); --text-primary: var(--text-primary-dark);
    --text-secondary: var(--text-secondary-dark); --border-color: var(--border-dark);
}

* { box-sizing: border-box; }
body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    background-color: var(--bg-color); color: var(--text-primary); margin: 0; padding: 2rem;
    display: flex; flex-direction: column; align-items: center; min-height: 100vh;
    transition: background-color 0.3s, color 0.3s;
}
.header { text-align: center; margin-bottom: 2rem; }
.header h1 { font-size: 2.5rem; font-weight: 700; display: flex; align-items: center; justify-content: center; gap: 0.75rem;}
.header p { font-size: 1.125rem; color: var(--text-secondary); margin-top: 0.5rem; }
#app-container { width: 100%; max-width: 1400px; }

#welcome-screen { text-align: center; padding: 2rem; }
.input-group { display: flex; max-width: 600px; margin: 2rem auto; box-shadow: var(--shadow); }
.input-group input { flex-grow: 1; padding: 1rem; font-size: 1rem; border: 1px solid var(--border-color); background-color: var(--card-bg); color: var(--text-primary); border-right: none; border-radius: var(--border-radius) 0 0 var(--border-radius); transition: all 0.2s; }
.input-group input::placeholder { color: var(--text-secondary); }
.input-group input:focus { outline: none; border-color: var(--accent-color); }
.input-group button { padding: 0 1.5rem; background-color: var(--accent-color); color: white; border: none; border-radius: 0 var(--border-radius) var(--border-radius) 0; font-size: 1rem; font-weight: 500; cursor: pointer; display: flex; align-items: center; gap: 8px; transition: background-color 0.2s; }
.input-group button:hover { background-color: var(--accent-hover); }
.input-group button:disabled { background-color: #a0aec0; cursor: not-allowed; }

#editor-screen { display: none; grid-template-columns: 350px 1fr; gap: 2rem; opacity: 0; transition: opacity 0.5s ease-in-out; }
#editor-screen.visible { display: grid; opacity: 1; }

#controls-sidebar { background-color: var(--card-bg); padding: 1.5rem; border-radius: var(--border-radius); box-shadow: var(--shadow); height: fit-content; position: sticky; top: 2rem; transition: background-color 0.3s; }
.control-section { margin-bottom: 2rem; }
.control-section h3 { font-size: 1.125rem; margin: 0 0 1rem 0; padding-bottom: 0.75rem; border-bottom: 1px solid var(--border-color); }
.layout-chooser { display: flex; gap: 1rem; background-color: var(--bg-color); padding: 5px; border-radius: 8px; }
.layout-chooser label { flex: 1; text-align: center; padding: 0.5rem; border-radius: 6px; cursor: pointer; transition: all 0.2s; user-select: none; }
.layout-chooser input { display: none; }
.layout-chooser input:checked + label { background-color: var(--card-bg); color: var(--accent-color); box-shadow: var(--shadow); }

.color-swatch-container { display: flex; flex-wrap: wrap; gap: 0.75rem; }
.color-swatch { width: 32px; height: 32px; border-radius: 50%; cursor: pointer; border: 2px solid transparent; transition: all 0.2s; }
.color-swatch.active { border-color: var(--accent-color); transform: scale(1.15); box-shadow: var(--shadow); }
.custom-color-pickers { display: none; gap: 1rem; margin-top: 1rem; }
.custom-color-pickers.visible { display: flex; }
.custom-color-pickers input { width: 100%; height: 40px; padding: 0; border: none; background: none; }

#preview-wrapper { display: flex; justify-content: center; align-items: flex-start; }
#capture-area { width: 100%; max-width: 720px; padding: 4rem; transition: background-image 0.4s; border-radius: 16px; position: relative; }
#card { width: 100%; border-radius: var(--border-radius); padding: 2rem; box-shadow: 0 25px 50px -12px rgb(0 0 0 / 0.25); transition: background-color 0.3s, color 0.3s; }
#card.light { background-color: var(--card-bg-light); color: var(--text-primary-light); }
#card.light .username { color: var(--text-primary-light); }
#card.light .handle, #card.light .card-footer { color: var(--text-secondary-light); }
#card.light .card-footer { border-top-color: var(--border-light); }

#card.dark { background-color: #1f2937; color: var(--text-primary-dark); }
#card.dark .username { color: #ffffff; }
#card.dark .handle, #card.dark .card-footer { color: var(--text-secondary-dark); }
#card.dark .card-footer { border-top-color: var(--border-dark); }

.card-header { display: flex; align-items: center; }
#avatar-preview { width: 50px; height: 50px; border-radius: 50%; object-fit: cover; margin-right: 1rem; background-color: #eee; }
.user-info { display: flex; flex-direction: column; }
#text-preview { font-size: 1.3em; line-height: 1.6; white-space: pre-wrap; word-wrap: break-word; margin: 1.5rem 0; }
.card-footer { display: flex; gap: 1.5rem; font-size: 0.9em; padding-top: 1.5rem; border-top: 1px solid; }

.media-grid { display: grid; gap: 3px; border-radius: var(--border-radius); overflow: hidden; margin-top: 1rem; aspect-ratio: 16 / 9; }
.media-grid img { width: 100%; height: 100%; object-fit: cover; }
.grid-2, .grid-4 { grid-template-columns: 1fr 1fr; }
.grid-3, .grid-4 { grid-template-rows: 1fr 1fr; }
.grid-3 img:first-child { grid-row: span 2; }
.media-waterfall { display: flex; flex-direction: column; gap: 0.75rem; margin-top: 1rem; }
.media-waterfall img { width: 100%; height: auto; border-radius: var(--border-radius); }

#watermark {
    position: absolute; bottom: 1.5rem; right: 1.5rem; display: flex; align-items: center; gap: 0.75rem;
    background-color: rgba(0, 0, 0, 0.4); color: white; padding: 0.4rem 0.8rem; border-radius: 8px;
    font-size: 0.8rem; backdrop-filter: blur(4px); -webkit-backdrop-filter: blur(4px);
}
#watermark svg { width: 16px; height: 16px; }

.download-button { width: 100%; padding: 1rem; margin-top: 2rem; background-color: var(--success-color); color: white; border: none; border-radius: 8px; font-size: 1.125rem; font-weight: 700; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; transition: background-color 0.2s; }
.download-button:hover { background-color: #2f9e74; }

#toast-container { position: fixed; bottom: 1.5rem; right: 1.5rem; z-index: 9999; display: flex; flex-direction: column; gap: 1rem; }
.toast { padding: 1rem 1.5rem; border-radius: 8px; color: white; box-shadow: var(--shadow); opacity: 0; transform: translateY(100%); animation: slideUp 0.5s forwards; display: flex; align-items: center; gap: 1rem; }
.toast.success { background-color: var(--success-color); } .toast.error { background-color: var(--error-color); } .toast.info { background-color: var(--accent-color); }
@keyframes slideUp { to { opacity: 1; transform: translateY(0); } }

footer { text-align: center; margin-top: 4rem; padding: 2rem; color: var(--text-secondary); }
footer a { color: var(--accent-color); text-decoration: none; }
footer a:hover { text-decoration: underline; }